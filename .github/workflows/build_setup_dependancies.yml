name: Cache Dependancies Test
run-name: ${{ github.actor }} is testing PowerShell caching
on: push
jobs:
  setup-build-dependancies:
    runs-on: ubuntu-latest
    timeout-minutes: 90
    steps:
      - uses: actions/checkout@v4
      - name: Setup PowerShell Module Cache
        id: cacher
        uses: actions/cache@v3
        with:
          path: "/home/runner/.local/share/powershell/Modules/"
          key: PS-Dependancies
      - name: Install dependencies
        if: steps.cacher.outputs.cache-hit != 'true'
        shell: pwsh
        run: |
          Set-PSRepository psgallery -InstallationPolicy trusted
          Install-Module -Name PowerShellGet -AllowPrerelease -Force
          Install-Module -Name AWS.Tools.Common -Force
          Install-Module -Name AWS.Tools.CodeArtifact -Force
          Install-Module -Name JumpCloud.SDK.DirectoryInsights -Force
          Install-Module -Name JumpCloud.SDK.V1 -Force
          Install-Module -Name JumpCloud.SDK.V2 -Force
          Install-Module -Name NuGet -Force